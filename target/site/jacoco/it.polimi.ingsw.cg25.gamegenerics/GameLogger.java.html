<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>GameLogger.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">cg25</a> &gt; <a href="index.source.html" class="el_package">it.polimi.ingsw.cg25.gamegenerics</a> &gt; <span class="el_source">GameLogger.java</span></div><h1>GameLogger.java</h1><pre class="source lang-java linenums">/**
 * 
 */
package it.polimi.ingsw.cg25.gamegenerics;

import java.io.IOException;
import java.util.logging.FileHandler;
import java.util.logging.Handler;
import java.util.logging.Level;
import java.util.logging.Logger;
import java.util.logging.SimpleFormatter;

/**
 * A simple logger
 * The standard usage is to have one file where all logs are stored and another with only critical information
 * @author Davide
 *
 */
public class GameLogger {
	
	/**
	 * Logger identifier
	 */
	private final String seed;
	
	/**
	 * File name for complete log
	 */
	private final String logFileName;
	
	/**
	 * File name for the exception log
	 */
	private final String exceptionFileName;
	
	/**
	 * Path for log files
	 */
	private final String logPath;
	
	/**
	 * Logger object
	 */
	private Logger logger;

	/**
	 * Minimum level to consider a message to be logged as critical
	 */
<span class="fc" id="L49">	public static final Level MIN_EX_LEVEL = Level.WARNING;</span>
	
	/**
	 * Minimum level to consider a message to be logged (at all)
	 */
<span class="fc" id="L54">	public static final Level MIN_MV_LEVEL = Level.CONFIG;</span>
	
	/**
	 * Default path where log files are stored
	 */
<span class="fc" id="L59">	public static final String DEFAULT_LOG_PATH = System.getProperty(&quot;user.dir&quot;)+&quot;/src/main/resources/logs/&quot;;</span>
	
	/**
	 * Creates a logger with no output attached
	 */
<span class="fc" id="L64">	public GameLogger(){</span>
<span class="fc" id="L65">		this.logPath = &quot;&quot;;</span>
<span class="fc" id="L66">		String rand = String.valueOf(System.nanoTime());</span>
<span class="fc" id="L67">		this.seed = &quot;FakeLog_&quot; + rand;</span>
<span class="fc" id="L68">		this.exceptionFileName = this.seed + &quot;_Ex&quot;;</span>
<span class="fc" id="L69">		this.logFileName = this.seed + &quot;_All&quot;;</span>

<span class="fc" id="L71">		this.logger = Logger.getLogger(this.seed);</span>

<span class="fc" id="L73">		this.logger.setUseParentHandlers(false);</span>
<span class="fc" id="L74">		this.logger.setLevel(Level.ALL);</span>
<span class="fc" id="L75">	}</span>
	
	/**
	 * Creates a logger with two files attached (one for all log infos, one for critical infos)
	 * 
	 * @param logID
	 *            String the match id (used as seed)
	 * @param logPath
	 *            String the directory path where log files will be stored
	 */
<span class="fc" id="L85">	public GameLogger(String logID, String logPath) {</span>
<span class="fc" id="L86">		this.logPath = logPath;</span>
<span class="fc" id="L87">		String rand = String.valueOf(System.nanoTime());</span>
<span class="fc" id="L88">		this.seed = logID + &quot;_&quot; + rand;</span>
<span class="fc" id="L89">		this.exceptionFileName = this.seed + &quot;_Ex&quot;;</span>
<span class="fc" id="L90">		this.logFileName = this.seed + &quot;_All&quot;;</span>

<span class="fc" id="L92">		this.logger = Logger.getLogger(this.seed);</span>

<span class="fc" id="L94">		this.logger.setUseParentHandlers(false);</span>
<span class="fc" id="L95">		this.logger.setLevel(Level.ALL);</span>
<span class="fc" id="L96">		SimpleFormatter formatter = new SimpleFormatter();</span>

		// Attach exception file to logger
		try {
<span class="fc" id="L100">			FileHandler fhEx = new FileHandler(this.logPath + this.exceptionFileName + &quot;.txt&quot;);</span>
<span class="fc" id="L101">			fhEx.setFormatter(formatter);</span>
<span class="fc" id="L102">			fhEx.setLevel(MIN_EX_LEVEL);</span>
<span class="fc" id="L103">			this.logger.addHandler(fhEx);</span>
<span class="nc" id="L104">		} catch (SecurityException | IOException e) {</span>
<span class="nc" id="L105">			e.printStackTrace();</span>
<span class="fc" id="L106">		}</span>

		// Attach moves file to logger
		try {
<span class="fc" id="L110">			FileHandler fhMv = new FileHandler(this.logPath + this.logFileName + &quot;.txt&quot;);</span>
<span class="fc" id="L111">			fhMv.setFormatter(formatter);</span>
<span class="fc" id="L112">			fhMv.setLevel(MIN_MV_LEVEL);</span>
<span class="fc" id="L113">			this.logger.addHandler(fhMv);</span>
<span class="nc" id="L114">		} catch (SecurityException | IOException e) {</span>
<span class="nc" id="L115">			e.printStackTrace();</span>
<span class="fc" id="L116">		}</span>
<span class="fc" id="L117">	}</span>

	/**
	 * Attach Handler to the logger
	 * 
	 * @param handler
	 *            {@link Handler} the handler to attach
	 * @param level
	 *            {@link Level} level of the handler (see MIN_EX_LEVEL and
	 *            MAX_EX_LEVEL static attributes)
	 */
	public void attachHandler(Handler handler, Level level) {
<span class="nc" id="L129">		handler.setLevel(level);</span>
<span class="nc" id="L130">		this.logger.addHandler(handler);</span>
<span class="nc" id="L131">	}</span>

	/**
	 * Log an exception
	 * 
	 * @param e
	 *            {@link Exception} The exception to log
	 * @param message
	 *            String The message to log
	 * @param level
	 *            {@link Level} The level of the log entry (Level.WARNING or
	 *            higher)
	 */
	public void log(Exception e, String message, Level level) {

<span class="fc" id="L146">		message.concat(&quot;\r\n&quot;);</span>

<span class="pc bpc" id="L148" title="1 of 2 branches missed.">		if (level.intValue() &lt; MIN_EX_LEVEL.intValue())</span>
<span class="nc" id="L149">			this.logger.log(MIN_EX_LEVEL, message, e);</span>
<span class="fc" id="L150">		this.logger.log(level, message, e);</span>

<span class="fc" id="L152">	}</span>

	/**
	 * Log an exception
	 * 
	 * @param e
	 *            {@link Exception} the exception to log
	 */
	public void log(Exception e) {
<span class="fc" id="L161">		this.log(e, &quot;&quot;, MIN_EX_LEVEL);</span>
<span class="fc" id="L162">	}</span>

	/**
	 * Log an exception
	 * 
	 * @param e
	 *            {@link Exception} the exception to log
	 * @param message
	 *            String the message to log
	 */
	public void log(Exception e, String message) {
<span class="fc" id="L173">		this.log(e, message, MIN_EX_LEVEL);</span>
<span class="fc" id="L174">	}</span>

	/**
	 * Log an exception
	 * 
	 * @param message
	 *            String the message to log
	 */
	public void warning(String message) {
<span class="nc" id="L183">		this.log(null, message, MIN_EX_LEVEL);</span>
<span class="nc" id="L184">	}</span>

	/**
	 * Log a message
	 * 
	 * @param message
	 *            String the message to log
	 * @param level
	 *            {@link Level} The level of the log entry (Level.INFO or
	 *            higher)
	 */
	public void log(String message, Level level) {

<span class="fc" id="L197">		message.concat(&quot;\r\n&quot;);</span>

<span class="pc bpc" id="L199" title="1 of 2 branches missed.">		if (level.intValue() &lt; MIN_MV_LEVEL.intValue())</span>
<span class="nc" id="L200">			this.logger.log(MIN_MV_LEVEL, message);</span>

<span class="fc" id="L202">		this.logger.log(level, message);</span>

<span class="fc" id="L204">	}</span>

	/**
	 * Log a message
	 * 
	 * @param message
	 *            String the message to log
	 */
	public void log(String message) {
<span class="fc" id="L213">		this.log(message, MIN_MV_LEVEL);</span>
<span class="fc" id="L214">	}</span>

	/**
	 * Closes &lt;b&gt;permanently&lt;/b&gt; all handler attached to the logger.
	 * &lt;p&gt;This &lt;b&gt;MUST&lt;/b&gt; be called when the logger is no more needed.
	 */
	public void close() {
<span class="pc bpc" id="L221" title="1 of 2 branches missed.">		for (Handler h : this.logger.getHandlers()) {</span>
<span class="nc" id="L222">			h.close();</span>
		}
<span class="fc" id="L224">	}</span>
	

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>