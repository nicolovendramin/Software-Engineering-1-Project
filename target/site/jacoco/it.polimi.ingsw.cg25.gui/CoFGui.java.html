<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>CoFGui.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">cg25</a> &gt; <a href="index.source.html" class="el_package">it.polimi.ingsw.cg25.gui</a> &gt; <span class="el_source">CoFGui.java</span></div><h1>CoFGui.java</h1><pre class="source lang-java linenums"><span class="nc" id="L1">package it.polimi.ingsw.cg25.gui;</span>
import java.awt.Color;
import java.awt.Font;
import java.awt.FontFormatException;
import java.awt.Graphics;
import java.awt.Image;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.KeyEvent;
import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.io.BufferedInputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.IOException;
import java.io.InputStream;
import java.util.ArrayList;
import java.util.List;
import java.awt.GraphicsEnvironment;
import javax.imageio.ImageIO;
import javax.swing.ImageIcon;
import javax.swing.JCheckBoxMenuItem;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JLayeredPane;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JOptionPane;
import javax.swing.KeyStroke;
import javax.swing.SwingUtilities;
import javax.swing.UIManager;
import javax.swing.UnsupportedLookAndFeelException;

import it.polimi.ingsw.cg25.actions.Interaction;
import it.polimi.ingsw.cg25.clients.GuiSimpleClient;
import it.polimi.ingsw.cg25.model.dto.GameStatus;
import it.polimi.ingsw.cg25.gui.guilisteners.AboutAction;
import it.polimi.ingsw.cg25.gui.guilisteners.ConnectionChoserActionListener;
import it.polimi.ingsw.cg25.gui.guilisteners.QuitAction;

/**
 * 
 * @author nicolo
 * @author Giovanni
 *
 */
@SuppressWarnings(&quot;serial&quot;)
public class CoFGui extends JFrame implements Updatable&lt;GameStatus&gt; {

	/**
	 * The frame width
	 */
	private static final int W_WIDTH = 1240;
	/**
	 * The frame height
	 */
	private static final int W_HEIGHT = 718;
	/**
	 * The space between balconies
	 */
	private static final int BAL_SPACING = 244;
	/**
	 * The client associated with this interface
	 */
	private GuiSimpleClient client;
	/**
	 * The menu of the frame
	 */
	private JMenuBar menuBar;
	/**
	 * The port chosen by the user for the connection
	 */
	private int port;
	/**
	 * The ip chosen by the user for the connection
	 */
	private String ip;
	/**
	 * The connection tyoe chosen by the user for the connection
	 */
	private String connectionType;
	/**
	 * The main font used by the gui
	 */
	private Font font;
	/**
	 * The icon of the window
	 */
	private ImageIcon frameIcon;
	/**
	 * The main content pane
	 */
	private JLayeredPane pane;
	/**
	 * The label that show the notification when there is a pending action interaction
	 */
	private JLabel notificationLabel;
	/**
	 * The background image for the window
	 */
	private Image background;
	/**
	 * The image of the king crown
	 */
	private Image crown;
	/**
	 * The flag to know if the action window is asked to be persistant or not
	 */
<span class="nc" id="L110">	private boolean persistanceFlag = false;</span>
	/**
	 * The label used to cover the whole window content pane when disabled
	 */
	private JLabel siparium;
	/**
	 * The JDialog used to display the choices for the action interaction
	 */
	private final ActionWindow choiceFrame;
	/**
	 * The list of panels that represent the balconies
	 */
	private final List&lt;BalconyPanel&gt; balconies;
	/**
	 * The panel used to display the nobility Track
	 */
	private NobilityTrackPanel nobTrackPanel;
	/**
	 * The panel used to display the informations related to the players 
	 * associated to this client
	 */
	private PlayerPanel player;
	/**
	 * The panel for the informations related to the king
	 */
	private KingRewardPanel kPanel;
	/**
	 * The panel used to display the informations related to the other players
	 */
	private OtherPlayersPanel otherPlayers;
	/**
	 * The panel offering chat functionalities
	 */
	private ChatPanel chatPanel;
	/**
	 * The panel with the map
	 */
	private MapPanel mapPanel;
	/**
	 * The text to display in the JOptionPane for user name change
	 */
<span class="nc" id="L151">	private String changeUsername = &quot;The name you type will be both your player' and chat' username&quot;;</span>
	
	/**
	 * CoFGui class constructor
	 * @param client a reference to a gui client
	 * @throws ClassNotFoundException
	 * @throws InstantiationException
	 * @throws IllegalAccessException
	 * @throws UnsupportedLookAndFeelException
	 * @throws IOException
	 */
<span class="nc" id="L162">	public CoFGui(GuiSimpleClient client) throws ClassNotFoundException, InstantiationException, </span>
		IllegalAccessException, UnsupportedLookAndFeelException, IOException {
<span class="nc" id="L164">		this.client = client;</span>
<span class="nc" id="L165">		     GraphicsEnvironment ge = </span>
<span class="nc" id="L166">		         GraphicsEnvironment.getLocalGraphicsEnvironment();</span>
		     try {
<span class="nc" id="L168">		    	 InputStream fontFile = new BufferedInputStream(</span>
<span class="nc" id="L169">		    			 new FileInputStream(&quot;src/main/resources/Fonts/GoudyMediaevalDemiBold.ttf&quot;));</span>
<span class="nc" id="L170">		    	 font = Font.createFont(Font.TRUETYPE_FONT, fontFile);</span>
<span class="nc" id="L171">				ge.registerFont(font);</span>
<span class="nc" id="L172">			} catch (IOException | FontFormatException e) {</span>
<span class="nc" id="L173">				font = new Font(&quot;SansSerif&quot;,Font.BOLD,20);</span>
<span class="nc" id="L174">				System.out.println(&quot;Failed while parsing font!&quot;);</span>
			}
<span class="nc" id="L176">		balconies = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L177">		choiceFrame = new ActionWindow(this);</span>
		//GUI initialising
<span class="nc" id="L179">		initGUI();</span>
<span class="nc" id="L180">	}</span>
	
	/**
	 * This method is used by the class constructor to 
	 * initialize the main JFrame which hosts the graphics interface
	 * @throws ClassNotFoundException
	 * @throws InstantiationException
	 * @throws IllegalAccessException
	 * @throws UnsupportedLookAndFeelException
	 * @throws IOException
	 */
	private void initGUI() throws ClassNotFoundException, InstantiationException, 
		IllegalAccessException, UnsupportedLookAndFeelException, IOException {
		//Setta le dimensioni
<span class="nc" id="L194">		setSize(W_WIDTH, W_HEIGHT);</span>
		//Posiziona la finestra al centro dello schermo
<span class="nc" id="L196">		setLocationRelativeTo(null);</span>
		//Setta il titolo della finestra
<span class="nc" id="L198">		setTitle(&quot;The Council of Four&quot;);</span>
		//Non ridimensionabile
<span class="nc" id="L200">		setResizable(false);</span>
		//Chiudi quando clicco sulla X
<span class="nc" id="L202">		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</span>
		
		//Set system LookAndFeel
<span class="nc" id="L205">		setLookAndFeel();</span>
<span class="nc" id="L206">		createMenu();</span>
		//Absolute layout
<span class="nc" id="L208">		this.setLayout(null);</span>
		
<span class="nc" id="L210">		loadResources();</span>
		
		//Set JFrame icon
<span class="nc" id="L213">		this.setIconImage(frameIcon.getImage());</span>
		//Set a background JLayeredPane
<span class="nc" id="L215">		pane = new JLayeredPane();</span>
<span class="nc" id="L216">		pane.setBounds(0, 0, this.getWidth(), this.getHeight());</span>
<span class="nc" id="L217">		setContentPane(pane);</span>
		
		//Add background scaled image
<span class="nc" id="L220">		Image scaledBackground = background.getScaledInstance(pane.getWidth(), pane.getHeight(), Image.SCALE_SMOOTH);</span>
<span class="nc" id="L221">		JLabel back = new JLabel(new ImageIcon(scaledBackground));</span>
<span class="nc" id="L222">		back.setBounds(pane.getX(), pane.getY(), pane.getWidth(), pane.getHeight());</span>
<span class="nc" id="L223">		pane.add(back);</span>
<span class="nc" id="L224">		pane.setLayer(back, 0);</span>
		
		//MAP
<span class="nc" id="L227">		mapPanel = new MapPanel(254, 93, 732, 486, font);</span>
<span class="nc" id="L228">		pane.add(mapPanel);</span>
<span class="nc" id="L229">		pane.setLayer(mapPanel, 1);</span>
		
		//CURRENT PLAYER
<span class="nc" id="L232">		player = new PlayerPanel(5, 5, 244, 327, getFont(), this);</span>
<span class="nc" id="L233">		pane.add(player);</span>
<span class="nc" id="L234">		pane.setLayer(player, 1);</span>
		
		//CHAT
<span class="nc" id="L237">		chatPanel = new ChatPanel(5, 337, 244, 327, this);</span>
<span class="nc" id="L238">		pane.add(chatPanel);</span>
<span class="nc" id="L239">		pane.setLayer(chatPanel, 1);</span>
		
		//OTHER PLAYERS
<span class="nc" id="L242">		otherPlayers = new OtherPlayersPanel(991, 5, 240, 516, font);</span>
<span class="nc" id="L243">		pane.add(otherPlayers);</span>
<span class="nc" id="L244">		pane.setLayer(otherPlayers, 1);</span>
		
		//NOBILITY
<span class="nc" id="L247">		nobTrackPanel = new NobilityTrackPanel(254, 5, 732, 86, font);</span>
<span class="nc" id="L248">		pane.add(nobTrackPanel);</span>
<span class="nc" id="L249">		pane.setLayer(nobTrackPanel, 1);</span>
		
		//BALCONIES
<span class="nc bnc" id="L252" title="All 2 branches missed.">		for(int i = 0; i &lt; 4; i++) {</span>
<span class="nc" id="L253">			BalconyPanel balcony = new BalconyPanel(264 + i*BAL_SPACING, 588, 224, 75);</span>
<span class="nc" id="L254">			balconies.add(balcony);</span>
<span class="nc" id="L255">			pane.add(balcony);</span>
<span class="nc" id="L256">			pane.setLayer(balcony, 1);</span>
		}
		
		//KING LOGO
<span class="nc" id="L260">		Image crownIcon = crown.getScaledInstance(40, 30, Image.SCALE_SMOOTH);</span>
<span class="nc" id="L261">		JLabel kingCrown = new JLabel(new ImageIcon(crownIcon));</span>
<span class="nc" id="L262">		kingCrown.setBounds(0, 0, 40, 30);</span>
<span class="nc" id="L263">		balconies.get(3).add(kingCrown);</span>
		
		//REWARD
<span class="nc" id="L266">		kPanel = new KingRewardPanel(1066, 525, 90, 51,font);</span>
<span class="nc" id="L267">		pane.add(kPanel);</span>
<span class="nc" id="L268">		pane.setLayer(kPanel, 1);</span>
		try {
<span class="nc" id="L270">			notificationLabel.setIcon(new ImageIcon(ImageIO.read(new File(&quot;src/main/resources/notifications.png&quot;)).getScaledInstance(20, 20, Image.SCALE_SMOOTH)));</span>
<span class="nc" id="L271">			notificationLabel.setBounds(215, 215, 20, 20);</span>
<span class="nc" id="L272">			notificationLabel.setVisible(false);</span>
<span class="nc" id="L273">			pane.add(notificationLabel);</span>
<span class="nc" id="L274">			pane.setLayer(notificationLabel, 3);</span>
			
<span class="nc" id="L276">		} catch (IOException e1) {</span>
			// TODO Auto-generated catch block
<span class="nc" id="L278">			e1.printStackTrace();</span>
		}
		
		//SPLASH SCREEN
		try{
<span class="nc" id="L283">			siparium = new JLabel();</span>
<span class="nc" id="L284">			siparium.setIcon(new ImageIcon(ImageIO.read(new File(&quot;src/main/resources/councilOfFour.jpg&quot;)).</span>
<span class="nc" id="L285">					getScaledInstance(this.getContentPane().getWidth(), this.getContentPane().getHeight(), Image.SCALE_SMOOTH)));</span>
<span class="nc" id="L286">			siparium.setBounds(0,0,this.getContentPane().getWidth(), this.getContentPane().getHeight());</span>
<span class="nc" id="L287">			pane.add(siparium);</span>
<span class="nc" id="L288">			pane.setLayer(siparium, 50);</span>
<span class="nc" id="L289">		}catch(Exception e){</span>
<span class="nc" id="L290">			e.printStackTrace();</span>
		}
		
<span class="nc" id="L293">		this.repaint();</span>
<span class="nc" id="L294">	}</span>
	
	/**
	 * Set the look and feel - Windows stile if you're using Windows as OS
	 * @throws ClassNotFoundException
	 * @throws InstantiationException
	 * @throws IllegalAccessException
	 * @throws UnsupportedLookAndFeelException
	 */
	private void setLookAndFeel() throws ClassNotFoundException, InstantiationException, IllegalAccessException, UnsupportedLookAndFeelException {
<span class="nc" id="L304">		UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());</span>
<span class="nc" id="L305">	}</span>


	@Override
	public void dispose(){
<span class="nc" id="L310">		new QuitAction().actionPerformed(null);</span>
<span class="nc" id="L311">		super.dispose();</span>
<span class="nc" id="L312">	}</span>

	/**
	 * Creates the frame menu
	 */
	private void createMenu() {
		//Crea una barra menu
<span class="nc" id="L319">		menuBar = new JMenuBar();</span>
		//Crea un menu &quot;Game&quot;
<span class="nc" id="L321">		JMenu gameMenu = new JMenu(&quot;Game&quot;);</span>
<span class="nc" id="L322">		menuBar.add(gameMenu);</span>
		
		//Aggiungi sottomenu di Game
<span class="nc" id="L325">		JMenuItem menuStart = new JMenuItem(&quot;Start&quot;);</span>
<span class="nc" id="L326">		menuStart.addActionListener(new ActionListener(){</span>

			@Override
			public void actionPerformed(ActionEvent e) {
<span class="nc bnc" id="L330" title="All 6 branches missed.">				if(connectionType!=null &amp;&amp; ip!=null &amp;&amp; port!=0)</span>
<span class="nc bnc" id="L331" title="All 2 branches missed.">					if(client.start(port, ip, connectionType))</span>
					{
<span class="nc" id="L333">						menuStart.setEnabled(false);</span>
<span class="nc" id="L334">						gameMenu.getItem(3).setEnabled(true);</span>
<span class="nc" id="L335">					}</span>
				else
<span class="nc" id="L337">					JOptionPane.showMessageDialog(null,&quot;You must setup your connection before  \nstarting the game. \nGo to Settings/Connection Settings.&quot;,&quot;Error&quot;,JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L338">			}</span>
			
		});
<span class="nc" id="L341">		menuStart.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_S,KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L342">		gameMenu.add(menuStart);</span>
<span class="nc" id="L343">		JMenuItem menuDisconnect = new JMenuItem(&quot;Disconnect&quot;);</span>
<span class="nc" id="L344">		menuDisconnect.addActionListener(new ActionListener(){</span>

			@Override
			public void actionPerformed(ActionEvent e) {
<span class="nc" id="L348">				client.disconnect(JOptionPane.showInputDialog(null, &quot;Type your disconnection message:&quot;, &quot;Disconnection Message&quot;, JOptionPane.PLAIN_MESSAGE));</span>
<span class="nc" id="L349">			}</span>
			
		});
<span class="nc" id="L352">		menuDisconnect.setEnabled(false);</span>
<span class="nc" id="L353">		JMenuItem menuChangeUsername = new JMenuItem(&quot;Change Username&quot;);</span>
<span class="nc" id="L354">		menuChangeUsername.addActionListener(new ActionListener(){</span>

			@Override
			public void actionPerformed(ActionEvent e) {
<span class="nc" id="L358">				String returned = JOptionPane.showInputDialog(null, changeUsername, &quot;Change your Username&quot;, JOptionPane.PLAIN_MESSAGE);</span>
<span class="nc bnc" id="L359" title="All 2 branches missed.">				if(returned != null)</span>
<span class="nc" id="L360">					client.changeUsername(returned);</span>
<span class="nc" id="L361">			}</span>
			
		});
<span class="nc" id="L364">		menuChangeUsername.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_N,KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L365">		gameMenu.add(menuChangeUsername);</span>
<span class="nc" id="L366">		JMenuItem menuConnect = new JMenuItem(&quot;Connect&quot;);</span>
<span class="nc" id="L367">		menuConnect.addActionListener(new ActionListener(){</span>

			@Override
			public void actionPerformed(ActionEvent e) {
<span class="nc" id="L371">				client.connect(JOptionPane.showInputDialog(null, &quot;Type your reconnection message:&quot;, &quot;Reconnection Message&quot;, JOptionPane.PLAIN_MESSAGE));</span>
<span class="nc" id="L372">			}</span>
			
		});
<span class="nc" id="L375">		menuConnect.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_C,KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L376">		gameMenu.add(menuConnect);</span>
<span class="nc" id="L377">		menuDisconnect.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_D,KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L378">		gameMenu.add(menuDisconnect);</span>
<span class="nc" id="L379">		JMenuItem menuQuit = new JMenuItem(&quot;Quit&quot;);</span>
<span class="nc" id="L380">		menuQuit.addActionListener(new QuitAction(this.getGuiClient()));</span>
<span class="nc" id="L381">		menuQuit.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_Q,KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L382">		gameMenu.add(menuQuit);</span>
		
		//Crea menu &quot;Options&quot;
<span class="nc" id="L385">		JMenu optionsMenu = new JMenu(&quot;Settings&quot;);</span>
<span class="nc" id="L386">		menuBar.add(optionsMenu);</span>
<span class="nc" id="L387">		JCheckBoxMenuItem persistance = new JCheckBoxMenuItem(&quot;Set automatic opening for Action Window&quot;);</span>
<span class="nc" id="L388">		persistance.setToolTipText(&quot;If this is checked every time an action is received the action panel is automatically opened&quot;);</span>
<span class="nc" id="L389">		persistance.addActionListener(new ActionListener(){</span>

			@Override
			public void actionPerformed(ActionEvent e) {
<span class="nc" id="L393">				persistanceFlag = persistance.isSelected();</span>
<span class="nc" id="L394">			}</span>
			
			
		});
<span class="nc" id="L398">		optionsMenu.add(persistance);</span>
<span class="nc" id="L399">		JMenuItem connectionSettings = new JMenuItem(&quot;Connection Settings&quot;);</span>
<span class="nc" id="L400">		connectionSettings.setAccelerator(KeyStroke.getKeyStroke(KeyEvent.VK_T,KeyEvent.CTRL_MASK));</span>
<span class="nc" id="L401">		connectionSettings.addActionListener(new ConnectionChoserActionListener(this));</span>
<span class="nc" id="L402">		optionsMenu.add(connectionSettings);</span>
		
		//Crea menu '?'
<span class="nc" id="L405">		JMenu helpMenu = new JMenu(&quot;?&quot;);</span>
<span class="nc" id="L406">		menuBar.add(helpMenu);</span>
		
		//Aggiungi sottomenu di ?
<span class="nc" id="L409">		JMenuItem menuAbout = new JMenuItem(&quot;About&quot;);</span>
<span class="nc" id="L410">		menuAbout.addActionListener(new AboutAction(font));</span>
<span class="nc" id="L411">		helpMenu.add(menuAbout);</span>
<span class="nc" id="L412">		this.setJMenuBar(menuBar);</span>
<span class="nc" id="L413">		notificationLabel = new JLabel();</span>
<span class="nc" id="L414">	}</span>
	
	/**
	 * Set the port to establish a connection
	 * @param port the number of the port to set
	 */
	protected void setPort(int port) {
<span class="nc" id="L421">		this.port = port;</span>
<span class="nc" id="L422">	}</span>
	
	/**
	 * Set the IP address of the server
	 * @param ip the IP address of the server to connect to
	 */
	protected void setIp(String ip) {
<span class="nc" id="L429">		this.ip = ip;</span>
<span class="nc" id="L430">	}</span>
	
	/**
	 * @return the set port of the connection
	 */
	protected int getPort() {
<span class="nc" id="L436">		return this.port;</span>
	}
	
	/**
	 * @return the set IP to establish the connection
	 */
	protected String getIp() {
<span class="nc" id="L443">		return this.ip;</span>
	}
	
	/**
	 * Set the connection type - Socket or RMI
	 * @param connectionType a string which represents the chosen connection type
	 */
	protected void setConnectionType(String connectionType) {
<span class="nc" id="L451">		this.connectionType = connectionType;</span>
<span class="nc" id="L452">	}</span>

	/**
	 * @return the connection type as a string
	 */
	protected String getConnectionType() {
<span class="nc" id="L458">		return this.connectionType;</span>
	}
	
	/**
	 * @return the connection type. True is Rmi
	 */
	protected boolean getSocketRmi() {
<span class="nc" id="L465">		return &quot;Rmi&quot;.equals(this.connectionType);</span>
	}
	
	/**
	 * Displays a message in the interface
	 * @param message the text message to be displayed
	 * @param error is a flag to decide if it is an error message or not. True = error message
	 */
	public void displayMessage(String message, boolean error) {
<span class="nc bnc" id="L474" title="All 2 branches missed.">		 if(!error)</span>
<span class="nc" id="L475">			 JOptionPane.showMessageDialog(null, message, &quot;Info&quot;, JOptionPane.INFORMATION_MESSAGE);</span>
		 else 
<span class="nc" id="L477">			 JOptionPane.showMessageDialog(null, message, &quot;Error&quot;, JOptionPane.ERROR_MESSAGE);</span>
<span class="nc" id="L478">	}</span>

	/**
	 * Prints the received message in the chat panel of the interface
	 * @param printOptions is the message to display
	 */
	public void chat(String message) {
<span class="nc" id="L485">		this.chatPanel.chat(message);</span>
<span class="nc" id="L486">	}</span>
	
	/**
	 * @return the GuiSimpleClient client related to this object
	 */
	public GuiSimpleClient getGuiClient() {
<span class="nc" id="L492">		return this.client;</span>
	}
	
	/**
	 * Adds or removes the notification icon over the action button 
	 * @param valueToNotify
	 */
	public void notify(boolean valueToNotify)
	{
<span class="nc" id="L501">		this.notificationLabel.setVisible(valueToNotify);</span>
<span class="nc" id="L502">	}</span>
	
	/**
	 * @return the font used in the gui
	 */
	public Font getFont(){
<span class="nc" id="L508">		return this.font;</span>
	}
	
	@Override
	public void update(GameStatus object) {
<span class="nc bnc" id="L513" title="All 2 branches missed.">		if(siparium!=null)</span>
		{
<span class="nc" id="L515">			this.changeUsername = &quot;As the game has already started, \nthe name you type will be your chat's username.\n Your Player's username will remain \nthe same&quot;;</span>
<span class="nc" id="L516">			pane.remove(siparium);</span>
<span class="nc" id="L517">			siparium = null;</span>
<span class="nc" id="L518">			pane.repaint();</span>
		}
		
<span class="nc bnc" id="L521" title="All 2 branches missed.">		for(int i = 0; i &lt; balconies.size()-1; i++)</span>
<span class="nc" id="L522">			balconies.get(i).update(object.getBoard().getRegions().get(i).getCouncil());</span>
<span class="nc" id="L523">		balconies.get(balconies.size()-1).update(object.getBoard().getKingCouncil());</span>
<span class="nc" id="L524">		mapPanel.update(object);</span>
<span class="nc" id="L525">		nobTrackPanel.update(object);</span>
<span class="nc" id="L526">		player.update(object.getRequestingPlayer());</span>
<span class="nc" id="L527">		kPanel.update(object.getBoard().getKingReward());</span>
<span class="nc" id="L528">		otherPlayers.update(object);</span>
		
<span class="nc bnc" id="L530" title="All 2 branches missed.">		if(!object.isRunning())</span>
		{
<span class="nc" id="L532">			final StringBuilder c = new StringBuilder(&quot;The game is over! Here is the rank:\n&quot;);</span>
<span class="nc" id="L533">			object.getHighScorers().stream().forEachOrdered(t -&gt; c.append(t.getName().concat(&quot; : &quot;).concat(Integer.toString(</span>
<span class="nc" id="L534">					t.getPocket().getVictoryPoints()).concat(&quot;\n&quot;))));</span>
<span class="nc" id="L535">			JOptionPane.showMessageDialog(null, c.toString(),</span>
<span class="nc bnc" id="L536" title="All 2 branches missed.">					((object.getHighScorers().indexOf(object.getRequestingPlayer())==0 || object.getHighScorers().get(0).</span>
<span class="nc bnc" id="L537" title="All 2 branches missed.">					getPocket().getVictoryPoints()==object.getRequestingPlayer().getPocket().getVictoryPoints()) ? &quot;Winner!&quot; : &quot;Loser&quot;), </span>
<span class="nc" id="L538">					JOptionPane.INFORMATION_MESSAGE);</span>
		}
		
<span class="nc" id="L541">		this.repaint();</span>
<span class="nc" id="L542">	}</span>
	
	/**
	 * Method used by the constructor to load gui resources
	 * @throws IOException if one or more resources are unreachable
	 */
	private void loadResources() throws IOException {
<span class="nc" id="L549">		frameIcon = new ImageIcon(&quot;src/main/resources/nobIcon.png&quot;);</span>
<span class="nc" id="L550">		background = ImageIO.read(new File(&quot;src/main/resources/Old_paper1.png&quot;));</span>
<span class="nc" id="L551">		crown = ImageIO.read(new File(&quot;src/main/resources/crown.png&quot;));</span>
<span class="nc" id="L552">	}</span>

	public void updateAction(Interaction actionInteraction) {
<span class="nc" id="L555">		this.choiceFrame.setActionInteraction(actionInteraction);</span>
<span class="nc" id="L556">		this.notify(true);</span>
<span class="nc bnc" id="L557" title="All 2 branches missed.">		if(this.persistanceFlag)</span>
<span class="nc" id="L558">			this.choiceFrame.display();</span>
<span class="nc" id="L559">	}</span>
	
	/**
	 * @return a reference to the action frame
	 */
	public ActionWindow getChoiceFrame() {
<span class="nc" id="L565">		return this.choiceFrame;</span>
	}
	
	/**
	 * Send to the client the filled action interaction
	 * @param actionInteraction is the filled action interaction
	 */
	public void replyAction(Interaction actionInteraction) {
<span class="nc" id="L573">		this.client.sendAction(actionInteraction);</span>
<span class="nc" id="L574">	}</span>
	
	/**
	 * This method provides the disconnection function
	 * @param message disconnection message will appear while disconnetting
	 */
	public void disconnect(String message){
<span class="nc" id="L581">		this.menuBar.getMenu(0).getItem(3).setEnabled(false);</span>
<span class="nc bnc" id="L582" title="All 4 branches missed.">		if(message!=null &amp;&amp; !&quot;&quot;.equals(message.replace(&quot; &quot;, &quot;&quot;)))</span>
<span class="nc" id="L583">			JOptionPane.showMessageDialog(null, message, &quot;Disconnection&quot;, JOptionPane.INFORMATION_MESSAGE);</span>
<span class="nc" id="L584">		this.siparium = new JLabel(){</span>
		    protected void paintComponent(Graphics g)
		    {
<span class="nc" id="L587">		        g.setColor( getBackground() );</span>
<span class="nc" id="L588">		        g.fillRect(0, 0, getWidth(), getHeight());</span>
<span class="nc" id="L589">		        super.paintComponent(g);</span>
<span class="nc" id="L590">		    }</span>
		};
<span class="nc" id="L592">		siparium.setText(&quot;&lt;html&gt;You are currently Disconnected.&lt;br&gt;Go to Game/Connect (CTRL + C) to reconnect.&lt;/html&gt;&quot;);</span>
<span class="nc" id="L593">		siparium.setHorizontalTextPosition(SwingUtilities.CENTER);</span>
<span class="nc" id="L594">		siparium.setVerticalTextPosition(SwingUtilities.CENTER);</span>
<span class="nc" id="L595">		siparium.setFont(new Font(this.getFont().getFontName(),Font.PLAIN,35));</span>
<span class="nc" id="L596">		siparium.setOpaque(false);</span>
<span class="nc" id="L597">		siparium.setBackground( new Color(0, 0, 0, 60) );</span>
<span class="nc" id="L598">	siparium.addMouseListener(new MouseListener() {</span>
			
			@Override
			public void mouseReleased(MouseEvent e) {
				// TODO Auto-generated method stub
				
<span class="nc" id="L604">			}</span>
			
			@Override
			public void mousePressed(MouseEvent e) {
				// TODO Auto-generated method stub
				
<span class="nc" id="L610">			}</span>
			
			@Override
			public void mouseExited(MouseEvent e) {
				// TODO Auto-generated method stub
				
<span class="nc" id="L616">			}</span>
			
			@Override
			public void mouseEntered(MouseEvent e) {
				// TODO Auto-generated method stub
				
<span class="nc" id="L622">			}</span>
			
			@Override
			public void mouseClicked(MouseEvent e) {
<span class="nc" id="L626">				JOptionPane.showMessageDialog(null, &quot;You are currently disconnected&quot;,</span>
<span class="nc" id="L627">						&quot;Disconnected&quot;, </span>
<span class="nc" id="L628">						JOptionPane.ERROR_MESSAGE);</span>
				
<span class="nc" id="L630">			}</span>
		});
<span class="nc" id="L632">		siparium.setBounds(0, 0, this.getContentPane().getWidth(), this.getContentPane().getHeight());</span>
<span class="nc" id="L633">		this.pane.add(siparium);</span>
<span class="nc" id="L634">		this.pane.setLayer(siparium, 52);</span>
<span class="nc" id="L635">	}</span>
	
	/**
	 * This method provides connection feature
	 * @param message the connection message
	 */
	public void connect(String message){
<span class="nc" id="L642">		this.menuBar.getMenu(0).getItem(3).setEnabled(true);</span>
<span class="nc bnc" id="L643" title="All 4 branches missed.">		if(message!=null &amp;&amp; !&quot;&quot;.equals(message.replace(&quot; &quot;, &quot;&quot;)))</span>
<span class="nc" id="L644">			JOptionPane.showMessageDialog(null, message, &quot;Connection&quot;, JOptionPane.INFORMATION_MESSAGE);</span>
<span class="nc" id="L645">		client.refresh(&quot;&quot;);</span>
<span class="nc" id="L646">	}</span>
	
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>