<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>DTOProduct.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">cg25</a> &gt; <a href="index.source.html" class="el_package">it.polimi.ingsw.cg25.model.dto.dtoproduct</a> &gt; <span class="el_source">DTOProduct.java</span></div><h1>DTOProduct.java</h1><pre class="source lang-java linenums">package it.polimi.ingsw.cg25.model.dto.dtoproduct;

import java.util.ArrayList;
import java.util.List;

import it.polimi.ingsw.cg25.exceptions.ElementNotFoundException;
import it.polimi.ingsw.cg25.model.dto.DTO;
import it.polimi.ingsw.cg25.model.dto.DTOPlayerCD4;
import it.polimi.ingsw.cg25.model.trade.Product;
import it.polimi.ingsw.cg25.model.trade.Sellable;

/**
 * 
 * @author Giovanni
 *
 * @param &lt;T&gt; specifies the type of objects included in the product
 * 
 */
public abstract class DTOProduct&lt;T extends DTOSellable&gt; implements DTO {

	/**
	 * Serial number for serial communication
	 */
	private static final long serialVersionUID = 8168423406926931295L;
	/**
	 * The price of the DTO product
	 */
	private final int price;
	/**
	 * The DTO player who is the owner of the product and wants to sell it
	 */
	private final DTOPlayerCD4 owner;
	/**
	 * The List of items to be sold included in the DTO product
	 */
	private final List&lt;T&gt; itemsToSell;
	/**
	 * The barcode of the DTO product
	 */
	private final int barcode;
	/**
	 * A ProductGenerator object which realizes a visitor pattern
	 */
<span class="fc" id="L44">	private static final ProductGenerator pg = new ProductGenerator();</span>
	
	/**
	 * DTOProduct class constructor
	 * @param price the price of the DTO product
	 * @param owner the owner of the DTO product
	 * @param itemsToSell the List of DTO products to sell
	 * @param barcode the barcode of the DTO product
	 */
<span class="fc" id="L53">	public DTOProduct(int price, DTOPlayerCD4 owner, List&lt;T&gt; itemsToSell, int barcode) {</span>
<span class="fc" id="L54">		this.price = price;</span>
<span class="fc" id="L55">		this.owner = owner;</span>
<span class="fc" id="L56">		this.itemsToSell = itemsToSell;</span>
<span class="fc" id="L57">		this.barcode = barcode;</span>
<span class="fc" id="L58">	}</span>
	
	/**
	 * This method is used to convert a single Product into a
	 * DTO product which implements DTOSellable interface
	 * @param toConvert the product to convert
	 * @return the DTO converted product
	 */
	public static DTOProduct&lt;? extends DTOSellable&gt; convert(Product&lt;? extends Sellable&gt; toConvert) {
<span class="fc" id="L67">		DTOProduct&lt;? extends DTOSellable&gt; converted = toConvert.generate(pg);</span>
<span class="fc" id="L68">		return converted;</span>
	}
	
	/**
	 * This method is used to convert a List of Products into a List of
	 * DTO products which implement DTOSellable interface
	 * @param toConvert the List of products to convert
	 * @return a List of converted DTO products
	 */
	public static List&lt;DTOProduct&lt;? extends DTOSellable&gt;&gt; convertAll(List&lt;Product&lt;? extends Sellable&gt;&gt; toConvert) {
<span class="fc" id="L78">		List&lt;DTOProduct&lt;? extends DTOSellable&gt;&gt; converted = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L79">		toConvert.forEach(p -&gt; converted.add(DTOProduct.convert(p)));</span>
		
<span class="fc" id="L81">		return converted;</span>
	}

	@Override
	public int hashCode() {
<span class="fc" id="L86">		final int prime = 31;</span>
<span class="fc" id="L87">		int result = 1;</span>
<span class="fc" id="L88">		result = prime * result + barcode;</span>
<span class="fc" id="L89">		result = prime * result + itemsToSell.hashCode();</span>
<span class="fc" id="L90">		result = prime * result + owner.hashCode();</span>
<span class="fc" id="L91">		result = prime * result + price;</span>
<span class="fc" id="L92">		return result;</span>
	}

	@SuppressWarnings(&quot;rawtypes&quot;)
	@Override
	public boolean equals(Object obj) {
<span class="fc bfc" id="L98" title="All 2 branches covered.">		if(obj == null)</span>
<span class="fc" id="L99">			return false;</span>
		//Se obj Ã¨ un DTOProduct...
<span class="fc bfc" id="L101" title="All 2 branches covered.">		if(obj instanceof DTOProduct) {</span>
<span class="fc" id="L102">			DTOProduct converted = (DTOProduct)obj;</span>
<span class="fc bfc" id="L103" title="All 2 branches covered.">			return this.barcode == converted.getBarcode();</span>
		}
<span class="fc bfc" id="L105" title="All 2 branches covered.">		if(obj instanceof Product) {</span>
<span class="fc" id="L106">			Product converted = (Product)obj;</span>
<span class="fc bfc" id="L107" title="All 2 branches covered.">			return this.barcode == converted.getBarcode();</span>
		}
<span class="fc" id="L109">		return false;</span>
	}

	/**
	 * The method allows to find a non-DTO product in a List of products
	 * which is equal to this DTOProduct object
	 * @param candidates a List of Product type objects
	 * @return a Product type object of the previous List
	 * @throws ElementNotFoundException if the list of candidates does not contain
	 * a product that can be mapped into this DTO Product
	 */
	public Product&lt;? extends Sellable&gt; decode(List&lt;Product&lt;? extends Sellable&gt;&gt; candidates) throws ElementNotFoundException {
<span class="fc bfc" id="L121" title="All 2 branches covered.">		for(Product&lt;? extends Sellable&gt; p : candidates)</span>
<span class="fc bfc" id="L122" title="All 2 branches covered.">			if(this.equals(p))</span>
<span class="fc" id="L123">				return p;</span>
<span class="fc" id="L124">		throw new ElementNotFoundException();</span>
	}
	
	/**
	 * It compares a List of DTOProduct objects to a List of Product objects and
	 * returns a List of decoded Product objects (see decode method)
	 * @param toDecode the List of DTOProduct objects to decode
	 * @param candidates the List of Product objects to compare
	 * @return a List of decoded products
	 * @throws ElementNotFoundException if a DTOProduct object does not appear
	 * in the List of condidates
	 */
	public static List&lt;Product&lt;? extends Sellable&gt;&gt; decodeAll(List&lt;DTOProduct&lt;? extends DTOSellable&gt;&gt; toDecode, 
			List&lt;Product&lt;? extends Sellable&gt;&gt; candidates) throws ElementNotFoundException {
		
<span class="fc" id="L139">		List&lt;DTOProduct&lt;? extends DTOSellable&gt;&gt; toDecodeCopy = new ArrayList&lt;&gt;(toDecode);</span>
<span class="fc" id="L140">		List&lt;Product&lt;? extends Sellable&gt;&gt; decoded = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L141">		List&lt;Product&lt;? extends Sellable&gt;&gt; candidateCopy = new ArrayList&lt;&gt;(candidates);</span>
<span class="fc bfc" id="L142" title="All 2 branches covered.">		for(DTOProduct&lt;? extends DTOSellable&gt; dc : toDecodeCopy){</span>
<span class="fc" id="L143">			Product&lt;? extends Sellable&gt; temp = dc.decode(candidateCopy);</span>
<span class="fc" id="L144">			decoded.add(temp);</span>
<span class="fc" id="L145">			candidateCopy.remove(temp);</span>
<span class="fc" id="L146">			}</span>
<span class="fc" id="L147">		return decoded;</span>
	}
	
	/**
	 * @return the price of the DTO product
	 */
	public int getPrice() {
<span class="fc" id="L154">		return price;</span>
	}

	/**
	 * @return the owner of the DTO product
	 */
	public DTOPlayerCD4 getOwner() {
<span class="fc" id="L161">		return owner;</span>
	}

	/**
	 * @return the List of items included in the DTO product
	 */
	public List&lt;T&gt; getItemsToSell() {
<span class="fc" id="L168">		return itemsToSell;</span>
	}

	/**
	 * @return the barcode of the DTO product
	 */
	public int getBarcode() {
<span class="fc" id="L175">		return barcode;</span>
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.6.201602180812</span></div></body></html>